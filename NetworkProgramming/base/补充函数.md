# 补充函数

## setsockopt

在C中，`setsockopt` 函数用于设置套接字选项。它允许你为已连接的套接字设置特定选项，并控制套接字的行为。通常在网络编程中，`setsockopt` 函数用于配置套接字的参数，例如设置超时、允许地址重用等。

以下是 `setsockopt` 函数的基本语法：

```c
int setsockopt(int sockfd, int level, int optname, const void *optval, socklen_t optlen);
```

其中:

- `sockfd`: 表示套接字文件描述符，即要设置选项的套接字
- `level`: 表示选项所属的协议层，常用的有 `SOL_SOCKET`、`SOL_TCP`、`SOL_UDP` 等
- `optname`: 表示要设置的选项的名称，比如设置超时、地址重用等
- `optval`: 是一个指向包含新选项值的缓冲区的指针
- `optlen`: 表示选项数值的大小，通常使用 `sizeof` 运算符来获取其大小

以下是一个简单的示例，演示了如何使用 `setsockopt` 函数来设置套接字的超时选项：

```c
#include <stdio.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>

int main() {
    int sockfd;
    struct timeval timeout;
    timeout.tv_sec = 5; // 设置超时时间为 5 秒
    timeout.tv_usec = 0;

    // 假设 sockfd 是一个已创建的套接字
    if (setsockopt(sockfd, SOL_SOCKET, SO_RCVTIMEO, &timeout, sizeof(timeout)) < 0) {
        perror("Error setting socket options");
    }

    // 其他操作
    // ...

    return 0;
}
```

在这个示例中，`setsockopt` 函数用于设置套接字的接收超时选项，这样在之后的接收操作中如果没有在指定时间内收到数据，操作将超时返回。这可以通过设置 `SO_RCVTIMEO` 选项实现。